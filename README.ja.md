# 📦 Storage System

**Language / 言語**

- 🇯🇵 日本語
- 🇬🇧 [English](./README.md)

---

## 1. このプロジェクトについて

**Storage System** は、企業でよく発生する以下の課題を解決するために設計された
**イベント駆動型のドキュメントストレージシステム**です。

> 「ファイルは保存されているが、その中身が有効活用できていない」

本システムでは、以下を実現しています。

- 高速なファイルアップロード
- 非同期での OCR（文字抽出）処理
- ファイル名・ファイル内容の両方による検索
- 将来的な拡張を前提としたスケーラブルな構成

本リポジトリは、システム全体の**アーキテクチャと設計思想をまとめたルートリポジトリ**です。

---

## 2. 背景・課題（なぜこのシステムを作ったのか）

多くの企業では、以下のようなドキュメントを日常的に扱っています。

- 契約書
- 請求書
- スキャンされた PDF
- 社内資料
- ユーザーがアップロードする書類

### よくある課題

| 課題                                 | ビジネス上の影響                 |
| ------------------------------------ | -------------------------------- |
| ファイルをバイナリとして保存するだけ | 中身を検索・活用できない         |
| OCR を同期処理で実行                 | アップロードが遅く、失敗しやすい |
| API と処理ロジックが密結合           | 保守・拡張が困難                 |
| 手作業での確認・検索                 | 運用コストが高い                 |

これらの問題は、データ量が増えるほど深刻になり、

- 業務効率の低下
- 運用コストの増加
- 新機能追加の難易度上昇

といった形でビジネスに影響します。

---

## 3. 設計方針

本システムでは、**技術的な新しさよりも、ビジネス的な持続性**を重視しました。

### 設計の目的

- ユーザー操作は常に高速に
- 重い処理は非同期で分離
- 抽出したデータは再利用可能に
- 将来的な拡張（AI・分析）に対応できる構造

そのため、以下の設計を採用しています。

- イベント駆動アーキテクチャ
- 明確な責務分離
- コンポーネント単位でのスケーリング

---

## 4. 全体アーキテクチャ

```
[ Frontend ]
     |
     v
[ Backend API ]
     |
     |---> オブジェクトストレージ（ファイル保存）
     |
     |---> メッセージブローカー（イベント）
                |
                v
      [ Content Processor（OCRワーカー） ]
```

### この構成を選んだ理由

- **ユーザー体験の向上**
  OCR 完了を待たずにアップロードが完了する

- **障害耐性**
  OCR 処理の失敗が API に影響しない

- **スケーラビリティ**
  ワーカーのみを独立してスケール可能

---

## 5. 処理フロー（End-to-End）

1. フロントエンドからファイルをアップロード
2. Backend API がアップロード用 URL を発行
3. ファイルをオブジェクトストレージに保存
4. `FileUploaded` イベントを発行
5. OCR ワーカーが非同期で文字抽出
6. `TextExtracted` イベントを発行
7. 抽出テキストを保存・検索可能に
8. ユーザーはファイル名・内容で検索可能

本システムでは **即時一貫性ではなく、結果整合性（Eventual Consistency）** を採用しています。
ドキュメント管理においては、十分に現実的な選択です。

---

## 6. リポジトリ構成と責務

本プロジェクトは、実務を想定し複数のリポジトリに分割されています。

| リポジトリ                    | 役割                            |
| ----------------------------- | ------------------------------- |
| **storage-domain**            | ドメインロジック・ユースケース  |
| **storage-be**                | API・認証・オーケストレーション |
| **storage-content-processor** | OCR 処理・非同期ワーカー        |
| **storage-fe**                | UI・UX                          |

### 分割した理由

- 責務の明確化
- 独立したデプロイ・スケーリング
- 保守性・テスト性の向上
- 実際のチーム開発構成を想定

---

## 7. 主な設計判断とトレードオフ

### OCR を非同期処理にした理由

**選択:** イベント駆動
**理由:** UX と安定性を最優先
**トレードオフ:** 即時検索不可（後続処理）

---

### ドメイン中心設計（DDD）

**選択:** ドメインロジックをインフラから分離
**理由:** 技術変更に強い設計
**トレードオフ:** 初期設計コスト

---

### シンプルな検索実装

**選択:** DB ベース検索
**理由:** 運用コストと複雑性を抑制
**トレードオフ:** 高度な全文検索は未対応

---

## 8. このプロジェクトで示したいこと

本プロジェクトでは、以下を重視しています。

- 課題をビジネス視点で捉える力
- スケーラブルな設計思考
- 非同期・イベント駆動の理解
- 技術選定における判断理由
- トレードオフを説明できる力

特定の技術を誇示することより、**設計意図**を重視しています。

---

## 9. 想定される利用シーン

- 人事システム（履歴書管理）
- 会計・請求書管理システム
- 社内ナレッジ管理
- ドキュメント中心の B2B SaaS

---

## 🔗 関連リポジトリ

- storage-domain
- storage-be
- storage-content-processor
- storage-fe
